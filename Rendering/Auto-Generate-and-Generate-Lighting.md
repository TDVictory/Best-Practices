# 自动生成和光照生成（Auto Generate and Generate Lighting）
## 自动生成光照（Auto Genenrate）
在新创建的场景内，**自动生成光照（Auto Genetate）** 开关是默认开启的。为了关闭该功能，我们需要前往**Lighting Settings** (位置: **Window > Lighting > Settings**) 窗口，关闭位于最底部的**Auto Generate**选项。

当你开启了**自动生成光照（Auto Generate）** 且当前场景使用了烘培的全局光照（Global Illumination 下简称GI）或者是预计算的实时全局光照时，每当你修改场景时Unity会自动重建光照数据。这也意味着每次场景中物体有影响烘培数据的移动时Unity后台都需要运行计算。举个例子来说，从场景中删除一个静态物体会触发一次烘培。

你只有在对单个场景进行迅速的光照修改迭代时才需要打开**自动生成光照（Auto Generate）** 开关。在其他情况下，你都不应该开启该功能，并每次人为地创建生成光照数据。

## 光照生成（Generate Lighting）
一旦你关闭了**自动生成光照（Auto Generate）** ，你可以通过点击**光照生成（Generate Lighting）** 按键。

### 光照数据资源（Lighting Data Asset）
当你点击**光照生成（Generate Lighting）** 按键后，Unity会在工程内创建一个**光照数据资源（Lighting Data Asset）**。这个光照数据资源包含了这个场景的全局光照数据，这些数据支持Unity来创建这个场景的光照。这些光照数据资源是与场景相互关联的（所以这些数据放置在场景对于的文件夹内）

当你使用了**自动生成光照（Auto Generate）** 时，Unity不会在工程中创建光照数据资源。相对的，Unity会将全局光照数据和其他的光照有关数据存储在内存中。这么做有两个原因：
- 变化修改存储在内存中的数据要比在文件中写入数据快得多。
- 改变一个已经关联了一个场景的光照数据资源是十分消耗资源的，因为该操作会触发Unity重新序列化场景。**自动生成光照（Auto Generate）** 目的是用来加速光照迭代的，因此每次迭代时不去触发这些大量消耗资源的操作是很有必要的。
# 在运行模式下用自动生成光照数据来测试场景
当在运行模式下进行场景测试时，磁盘上缺乏光照数据资源可能会带来许多问题。简而言之，使用了自动生成光照数据的场景只有下下述情况下能够展示所有正确的全局光照数据

情况1：
- 在编辑模式下，一个场景对于单场景编辑开放（不知道啥意思，原文A Scene is open for single-Scene editing in Edit Mode）
- 你在编辑模式只对该场景进行编辑切换到运行模式下只测试该场景。

情况2
- 在编辑模式下，一系列场景对于多场景编辑开放。
- 你在编辑模式下对这一系列场景进行编辑切换到在运行模式下对这一系列场景进行测试

任何其他的情况都会导致使用了自动生成光照数据的场景在运行模式下产生明显的错误。实时光照（例如天空盒或是环境漫反射光数据）仍在运作，但是全局光照丢失。
## 在运行模式下使用自动生成光照数据的问题
### 在运行模式下卸载（Unload）场景
当你在运行模式下测试一个单独或者是一系列使用了自动生成光照数据的场景，如果卸载了场景，Unity会丢失那些场景的全局光照数据。

这是因为对于一个使用了自动生成光照的场景来说，Unity进入运行模式时，该场景全局光照数据将直接关联在物体自身上。当Unity卸载了该场景后，它会自动删除场景所有的物体一并删除所有的全局光照数据。因为在磁盘上已经没有了光照数据资源可以提供给Unity来重载全局光照数据，如果不返回编辑模式Unity将不能恢复这些数据。这也意味着如果Unity在同一个运行模式期间内再次加载同样的场景时，该场景将不再包含全局光照数据。
### 在运行模式下读取额外的场景
当你在编辑模式下打开一个开启了自动生成光照的场景，Unity会从GI缓存中读取该场景的全局光照数据或者生成该场景的全局光照数据。这个全局光照数据和其他有关场景的光照数据一同依赖于内存，且当你进入运行模式下会被正确关联在一起。
当Unity在运行模式下通过用户脚本加载一个通过自动生成光照模式烘培的场景时，它的全局光照数据并不存在于内存之中。如果你不是叠加式加载（LoadSceneMode.Additive）场景，该场景将展现出明显的错误。如果你使用了叠加式加载，其展现的效果将会比较微妙，其光照问题也不会像不使用那么明显。
### 多场景编辑
当有多个开启了自动生成光照的场景开放给编解时，Unity将这以特定方式组合的场景的所有光照数据存储在内存中。
如果你只想测试场景的特殊组合（通过进入运行模式），你可以用多场景编辑这种方法来做到对这多个场景进行迅速地光照迭代。当你有多个开放场景时进入运行模式，Unity不需要从磁盘读取任何状态，因为所有场景内的元素都已经关联上了全局光照数据
然而，如果你想要在运行模式下测试另一种场景的组合，或者是用另一种方式读取同样的场景（比如说，先读取场景A，然后再叠加式地添加场景B和场景C），你将会遇到问题。任何带有自动产生光照模式的场景只要不是进入运行模式时就最初存在的，都将不带有全局光照数据

[返回上一级](/Rendering/Lighting-Scenes.md)

[返回主页](/README.md)
